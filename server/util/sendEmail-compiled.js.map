{"version":3,"sources":["sendEmail.js"],"names":[],"mappings":";;;;;QAUgB,Y,GAAA,Y;QA+BA,U,GAAA,U;QAgBA,a,GAAA,a;;AAtDhB;;;;;;AAEA,IAAI,WAAW,QAAQ,YAAR,CAAf,C,CALA;;;;AAMA,IAAI,aAAa,QAAQ,YAAR,CAAjB;AACA,IAAI,YAAY,QAAQ,aAAR,CAAhB;AACA,IAAI,YAAY,IAAI,SAAJ,EAAhB;;AAEO,SAAS,YAAT,CAAsB,GAAtB,EAA2B,QAA3B,EAAqC,MAArC,EAA6C;AAClD,MAAI,aAAa;AACf,UAAM,gBADS;AAEf,UAAM,GAFS;AAGf,YAAQ,IAHO,EAGD;AACd,UAAM;AACJ,YAAM,uBADF;AAEJ,YAAM;AAFF;AAJS,GAAjB;AASA;AACA,MAAI,cAAc,WAAW,eAAX,CAA2B,UAA3B,CAAlB;AACA,MAAI,cAAc;AAChB,UAAM,0CADU;AAEhB,QAAI,SAAS,KAFG;AAGhB,aAAS,wBAHO;AAIhB,UAAM,kCAAiC,MAJvB;AAKhB,UAAM,yGAAuG,SAAS,KAAhH,GAAsH,cAAtH,GAAqI,MAArI,GAA4I;AALlI,GAAlB;AAOA,cAAY,QAAZ,CAAqB,WAArB,EAAkC,UAAU,KAAV,EAAiB,IAAjB,EAAuB;AACvD,QAAI,KAAJ,EAAW;AACT,cAAQ,GAAR,CAAY,KAAZ;AACA,gBAAU,QAAV,CAAmB,SAAS,aAA5B,EAA2C,GAA3C,EAAgD,KAAhD,EAAuD,SAAS,uBAAhE,EAAyF,yBAAzF;AACD,KAHD,MAGO;AACL;AACA,gBAAU,QAAV,CAAmB,SAAS,aAA5B,EAA2C,GAA3C,EAAgD,IAAhD,EAAsD,SAAS,0BAA/D,EAA2F,4BAA3F;AACD;AACF,GARD;AASD;;AAGM,SAAS,UAAT,CAAoB,KAApB,EAA2B,UAA3B,EAAuC,QAAvC,EAAiD;AACtD,MAAI,QAAQ,EAAC,SAAS,KAAV,EAAiB,cAAc,UAA/B,EAA2C,YAAW,CAAtD,EAAZ;AACA,qBAAS,gBAAT,CAA0B,KAA1B,EAAiC,EAAC,cAAa,CAAd,EAAiB,YAAW,CAA5B,EAAjC,EAAiE;AAC/D,UAAM;AADyD,GAAjE,EAEG,UAAU,GAAV,EAAe,KAAf,EAAsB;AACvB,YAAQ,GAAR,CAAY,GAAZ;AACA,YAAQ,GAAR,CAAY,KAAZ;AACA,QAAI,UAAU,IAAd,EAAmB;AACjB,eAAS,IAAT;AACD,KAFD,MAEM;AACJ,eAAS,KAAT;AACD;AACF,GAVD;AAWD;;AAGM,SAAS,aAAT,CAAuB,KAAvB,EAA8B,QAA9B,EAAwC;AAC7C,MAAI,QAAQ,EAAC,SAAS,KAAV,EAAZ;AACA,qBAAS,OAAT,CAAiB,KAAjB,EAAwB,UAAU,GAAV,EAAe,QAAf,EAAyB;AAC/C,YAAQ,GAAR,CAAY,GAAZ;AACA,YAAQ,GAAR,CAAY,QAAZ;AACA,QAAI,aAAa,IAAjB,EAAsB;AACpB,eAAS,IAAT;AACD,KAFD,MAEM;AACJ,eAAS,KAAT;AACD;AACF,GARD;AASD;;;;;;;;gCA5DG,S;;gCAEY,Y;;gCA+BA,U;;gCAgBA,a","file":"sendEmail-compiled.js","sourcesContent":["/**\n * Created by thientran on 8/14/16.\n */\nimport UserInfo from '../models/userinfo';\n\nvar constant = require('./constant');\nvar nodemailer = require('nodemailer');\nvar Fconstant = require('./fconstant');\nvar fconstant = new Fconstant();\n\nexport function confirmEmail(res, userinfo, number) {\n  var smtpConfig = {\n    host: 'smtp.gmail.com',\n    port: 465,\n    secure: true, // use SSL\n    auth: {\n      user: 'thientt@topica.edu.vn',\n      pass: 'ttttttttA1@'\n    }\n  };\n  //  var transporter = nodemailer.createTransport('smtps://dev.edn.com.vn%40gmail.com:Edn102013@smtp.gmail.com');\n  var transporter = nodemailer.createTransport(smtpConfig);\n  var mailOptions = {\n    from: 'Topica - ThienTT <thientt@topica.edu.vn>',\n    to: userinfo.email,\n    subject: 'Acive Code from Topica',\n    text: 'Hi Your link active code is: ' +number,\n    html: '<h1>Hi from Topica</h1><p>Your active link is: <a href=\"http://localhost:8000/api/auth/verify?email='+userinfo.email+'&activecode='+number+'\">Active Now</a></p>'\n  };\n  transporter.sendMail(mailOptions, function (error, info) {\n    if (error) {\n      console.log(error);\n      fconstant.response(constant.RES_TYPE_JSON, res, false, constant.CREATE_ACTIVE_CODE_FAIL, 'CREATE_ACTIVE_CODE_FAIL');\n    } else {\n      //console.log(info.response);\n      fconstant.response(constant.RES_TYPE_JSON, res, true, constant.CREATE_ACTIVE_CODE_SUCCESS, 'CREATE_ACTIVE_CODE_SUCCESS');\n    }\n  });\n}\n\n\nexport function verifyUser(email, activecode, callback) {\n  var query = {'email': email, 'activecode': activecode, 'isactive':0};\n  UserInfo.findOneAndUpdate(query, {'activecode':0, 'isactive':1}, {\n    safe: true,\n  }, function (err, model) {\n    console.log(err);\n    console.log(model);\n    if (model !== null){\n      callback(true)\n    }else {\n      callback(false)\n    }\n  });\n}\n\n\nexport function checkUserExit(email, callback) {\n  var query = {'email': email};\n  UserInfo.findOne(query, function (err, userinfo) {\n    console.log(err);\n    console.log(userinfo);\n    if (userinfo !== null){\n      callback(true)\n    }else {\n      callback(false)\n    }\n  });\n}\n\n"]}