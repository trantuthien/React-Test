{"version":3,"sources":["userinfo.controller-compiled.js"],"names":[],"mappings":"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","file":"userinfo.controller-compiled-compiled.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addUser = addUser;\nexports.verify = verify;\n\nvar _userinfo = require('../models/userinfo');\n\nvar _userinfo2 = _interopRequireDefault(_userinfo);\n\nvar _cuid = require('cuid');\n\nvar _cuid2 = _interopRequireDefault(_cuid);\n\nvar _limax = require('limax');\n\nvar _limax2 = _interopRequireDefault(_limax);\n\nvar _sanitizeHtml = require('sanitize-html');\n\nvar _sanitizeHtml2 = _interopRequireDefault(_sanitizeHtml);\n\nvar _sendEmail = require('../util/sendEmail');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Created by thientran on 8/13/16.\n */\nvar constant = require('../util/constant');\nvar Fconstant = require('../util/fconstant');\nvar fconstant = new Fconstant();\n\n/**\n * Get all posts\n * @param req\n * @param res\n * @returns void\n */\n// export function getPosts(req, res) {\n//   UserInfo.find().sort('-dateAdded').exec((err, posts) => {\n//     if (err) {\n//       res.status(500).send(err);\n//     }\n//     res.json({ posts });\n//   });\n// }\n\n/**\n * Save a post\n * @param req\n * @param res\n * @returns void\n */\nfunction addUser(req, res) {\n  console.log(req.body.userinfo);\n  var userinfo = new _userinfo2.default(req.body.userinfo);\n\n  (0, _sendEmail.checkUserExit)(userinfo.email, function (isExit) {\n    if (isExit) {\n      fconstant.response(constant.RES_TYPE_JSON, res, false, constant.RES_USER_EXISTS, 'RES_USER_EXISTS');\n    } else {\n      var number = fconstant.hashPlainTextPassword(new Date().getTime().toString());\n      userinfo.isactive = 0;\n      userinfo.activecode = number;\n      userinfo.save(function (err, userreturn) {\n        if (err) return console.error(err);\n        (0, _sendEmail.confirmEmail)(res, userreturn, number);\n      });\n    }\n  });\n  //\n  // var userinfo = JSON.parse(req.body.userinfo);\n  // if (!userinfo || !userinfo.username || !userinfo.email || !userinfo.password) {\n  //   res.status(403).end();\n  // }\n  //\n  // const newUser = new UserInfo(req.body.userinfo);\n  //\n  // // Let's sanitize inputs\n  // newUser.username = sanitizeHtml(newUser.username);\n  // newUser.email = sanitizeHtml(newUser.email);\n  // newUser.password = sanitizeHtml(newUser.password);\n  //\n  // newUser.cuid = cuid();\n  // newUser.save((err, saved) => {\n  //   if (err) {\n  //     res.status(500).send(err);\n  //   }\n  //   res.json({ newUser: saved });\n  // });\n}\n\nfunction verify(req, res) {\n  console.log(req.path);\n  console.log(req.query);\n  if (req.path == '/verify') {\n    (0, _sendEmail.verifyUser)(req.query.email, req.query.activecode, function (isSuccess) {\n      if (isSuccess) {\n        //fconstant.response(constant.RES_TYPE_JSON, res, true, constant.CREATE_ACTIVE_CODE_SUCCESS, 'CREATE_ACTIVE_CODE_SUCCESS');\n        res.redirect('/sign-up');\n      } else {\n        res.status(403).json({ success: false, message: 'WRONG USER' });\n      }\n    });\n  } else {\n    res.status(403).json({ success: false, message: 'WRONG USER' });\n  }\n  // if (req.path == '/authenticate') next();\n}\n;\n\n(function () {\n  if (typeof __REACT_HOT_LOADER__ === 'undefined') {\n    return;\n  }\n\n  __REACT_HOT_LOADER__.register(fconstant, 'fconstant', '/Users/thientran/Documents/SourceTree/React-Test/server/controllers/userinfo.controller.js');\n\n  __REACT_HOT_LOADER__.register(addUser, 'addUser', '/Users/thientran/Documents/SourceTree/React-Test/server/controllers/userinfo.controller.js');\n\n  __REACT_HOT_LOADER__.register(verify, 'verify', '/Users/thientran/Documents/SourceTree/React-Test/server/controllers/userinfo.controller.js');\n})();\n\n;\n\n//# sourceMappingURL=userinfo.controller-compiled.js.map"]}